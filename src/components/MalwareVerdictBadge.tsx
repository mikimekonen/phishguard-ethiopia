import { AlertTriangle, HelpCircle, ShieldAlert, ShieldCheck } from "lucide-react";

export type MalwareVerdict = "MALICIOUS" | "SUSPICIOUS" | "CLEAN" | "UNKNOWN";

type VerdictConfig = {
  label: string;
  aria: string;
  className: string;
  Icon: typeof ShieldCheck;
};

const verdictConfig: Record<MalwareVerdict, VerdictConfig> = {
  // MALICIOUS → red background (#dc2626), white text, warning icon
  MALICIOUS: {
    label: "MALICIOUS",
    aria: "Malware verdict: malicious",
    className: "bg-[#dc2626] text-white",
    Icon: ShieldAlert,
  },
  // SUSPICIOUS → amber/orange (#f59e0b), dark text, alert icon
  SUSPICIOUS: {
    label: "SUSPICIOUS",
    aria: "Malware verdict: suspicious",
    className: "bg-[#f59e0b] text-slate-900",
    Icon: AlertTriangle,
  },
  // CLEAN → green (#16a34a), white text, check icon
  CLEAN: {
    label: "CLEAN",
    aria: "Malware verdict: clean",
    className: "bg-[#16a34a] text-white",
    Icon: ShieldCheck,
  },
  // UNKNOWN → gray (#6b7280), white text, question icon
  UNKNOWN: {
    label: "UNKNOWN",
    aria: "Malware verdict: unknown",
    className: "bg-[#6b7280] text-white",
    Icon: HelpCircle,
  },
};

type MalwareVerdictBadgeProps = {
  verdict: MalwareVerdict;
};

export function MalwareVerdictBadge({ verdict }: MalwareVerdictBadgeProps) {
  const safeVerdict: MalwareVerdict = verdictConfig[verdict] ? verdict : "UNKNOWN";
  const { label, aria, className, Icon } = verdictConfig[safeVerdict];

  return (
    <span
      aria-label={aria}
      className={`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-semibold uppercase tracking-wide ring-1 ring-black/10 dark:ring-white/20 ${className}`}
    >
      <Icon className="h-4 w-4" aria-hidden="true" />
      <span>{label}</span>
    </span>
  );
}
